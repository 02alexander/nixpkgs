From 06418362d5a6c8bc592acb7572f4d1b48213884f Mon Sep 17 00:00:00 2001
From: Will Bush <will.g.bush@gmail.com>
Date: Sun, 31 Jul 2022 02:48:18 -0500
Subject: [PATCH] meson: add options for tests installation dirs

---
 json-glib/tests/meson.build | 13 +++++++++++--
 meson_options.txt           |  6 ++++++
 2 files changed, 17 insertions(+), 2 deletions(-)

diff --git a/json-glib/tests/meson.build b/json-glib/tests/meson.build
index 1eb56c8..beab6c7 100644
--- a/json-glib/tests/meson.build
+++ b/json-glib/tests/meson.build
@@ -21,8 +21,17 @@ test_data = [
   'stream-load.json',
 ]
 
-installed_test_bindir = join_paths(json_libexecdir, 'installed-tests', json_api_name)
-installed_test_datadir = join_paths(json_datadir, 'installed-tests', json_api_name)
+installed_test_suffix = join_paths('installed-tests', json_api_name)
+
+installed_test_bindir = join_paths(get_option('installed_test_bindir'), installed_test_suffix)
+if installed_test_bindir == ''
+  installed_test_bindir = join_paths(json_libexecdir, installed_test_suffix)
+endif
+
+installed_test_datadir = join_paths(get_option('installed_test_datadir'), installed_test_suffix)
+if installed_test_datadir == ''
+  installed_test_datadir = join_paths(json_datadir, installed_test_suffix)
+endif
 
 install_data(test_data, install_dir: installed_test_bindir)
 
diff --git a/meson_options.txt b/meson_options.txt
index 068a03f..b3b1837 100644
--- a/meson_options.txt
+++ b/meson_options.txt
@@ -10,3 +10,9 @@ option('man',
 option('tests',
        type: 'boolean', value: true,
        description: 'Build the tests')
+option('installed_test_datadir', type: 'string',
+       value: '',
+       description: 'Installation directory for data files in tests')
+option('installed_test_bindir', type: 'string',
+       value: '',
+       description: 'Installation directory for binary files in tests')
-- 
2.36.1

