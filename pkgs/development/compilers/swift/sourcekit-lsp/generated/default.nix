# This file was generated by swiftpm2nix.
{ lib, fetchgit }: rec {
  sources = {
    "indexstore-db" = fetchgit {
      url = "https://github.com/apple/indexstore-db.git";
      rev = "2ff1c0491248cd958a2ac05da9aa613eb27a8eeb";
      sha256 = "005vvkrncgpryzrn0hzgsapflpyga0n7152b2b565wislpx90cwl";
    };
    "swift-argument-parser" = fetchgit {
      url = "https://github.com/apple/swift-argument-parser.git";
      rev = "e394bf350e38cb100b6bc4172834770ede1b7232";
      sha256 = "1jph9w7lk9nr20fsv2c8p4hisx3dda817fh7pybd0r0j1jwa9nmw";
    };
    "swift-collections" = fetchgit {
      url = "https://github.com/apple/swift-collections.git";
      rev = "f504716c27d2e5d4144fa4794b12129301d17729";
      sha256 = "0l0pv16zil3n7fac7mdf5qxklxr5rwiig5bixgca1ybq7arlnv7i";
    };
    "swift-crypto" = fetchgit {
      url = "https://github.com/apple/swift-crypto.git";
      rev = "ddb07e896a2a8af79512543b1c7eb9797f8898a5";
      sha256 = "020b8q4ss2k7a65r5dgh59z40i6sn7ij1allxkh8c8a9d0jzn313";
    };
    "swift-driver" = fetchgit {
      url = "https://github.com/apple/swift-driver.git";
      rev = "6c71f58f89d65eb79f1f6b32a707ddc39cec5ad6";
      sha256 = "0nblvs47kh2hl1l70rmrbablx4m5i27w8l3dfrv2h7zccqr8jl0a";
    };
    "swift-llbuild" = fetchgit {
      url = "https://github.com/apple/swift-llbuild.git";
      rev = "d99c31577c60a247b065d29289a44fbdd141e2be";
      sha256 = "1bvqbj8ji72ilh3ah2mw411jwzbbjxjyasa6sg4b8da0kqia4021";
    };
    "swift-package-manager" = fetchgit {
      url = "https://github.com/apple/swift-package-manager.git";
      rev = "f04ad469a6053d713c2fb854fbeb27ee3e6c9dee";
      sha256 = "16qvk14f1l0hf5bphx6qk51nn9d36a2iw5v3sgkvmqi8h7l4kqg5";
    };
    "swift-system" = fetchgit {
      url = "https://github.com/apple/swift-system.git";
      rev = "836bc4557b74fe6d2660218d56e3ce96aff76574";
      sha256 = "0402hkx2q2dv27gccnn8ma79ngvwiwzkhcv4zlcdldmy6cgi0px7";
    };
    "swift-tools-support-core" = fetchgit {
      url = "https://github.com/apple/swift-tools-support-core.git";
      rev = "0220fc394f2ae820eeacd754fb2c7ce211e9979e";
      sha256 = "1ryd5iyx5mfv8bhyq3bf08z7nv886chzzqnmwaj16r2cry9yml7c";
    };
    "Yams" = fetchgit {
      url = "https://github.com/jpsim/Yams.git";
      rev = "01835dc202670b5bb90d07f3eae41867e9ed29f6";
      sha256 = "11abhcfkmqm3cmh7vp7rqzvxd1zj02j2866a2pp6v9m89456xb76";
    };
  };
  configure = ''
    mkdir -p .build/checkouts
    ln -sf ${./Package.resolved} ./Package.resolved
    install -m 0600 ${./workspace-state.json} ./.build/workspace-state.json
  ''
    + lib.concatStrings (lib.mapAttrsToList (name: src: ''
      ln -s '${src}' '.build/checkouts/${name}'
    '') sources)
    + ''
      # Helper that makes a swiftpm dependency mutable by copying the source.
      swiftpmMakeMutable() {
        local orig="$(readlink .build/checkouts/$1)"
        rm .build/checkouts/$1
        cp -r "$orig" .build/checkouts/$1
        chmod -R u+w .build/checkouts/$1
      }
    '';
}
